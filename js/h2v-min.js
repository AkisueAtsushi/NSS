/* h2v.js version 3.3.0
    last modified at July 27 2013
    (c)tyz@freefielder.jp 
    For detail , please visit http://tategaki.info/h2v/
		Contact : tyz@freefielder.jp
    ** Don't remove this copyright message **
*/
var h2vconvert={version:"3.3.0",target:{},defaultval:{auto:true,chars:25,fontsize:"16px",lineInterval:0.4,rotate:true,bar:true,barForeColor:"#999",barBackColor:"#eee",showcredit:true,multiCols:true,splash:true,fontSet:"gothic"},fontSet:{gothic:"'ヒラギノ角ゴ ProN','Hiragino Kaku Gothic ProN','ヒラギノ角ゴ Pro','Hiragino Kaku Gothic Pro','メイリオ','Meiryo','ＭＳ ゴシック','MS Gothic','SimHei','HiraKakuProN-W3','STHeitiJ-Medium','TakaoExゴシック','TakaoExGothic','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace",mincho:"'HGS明朝E','ヒラギノ明朝 ProN','Hiragino Mincho ProN','ヒラギノ明朝 Pro','Hiragino Mincho Pro','ＭＳ 明朝','MS Mincho','SimSun','HiraMinProN-W3','STHeitiJ-Medium','TakaoEx明朝','TakaoExMincho','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace"},tmpdiv:null,styleSet:false,envs:{ua:"",isOld:false,isIE8:false,isIE:false},init:function(d){var c=h2vconvert,a=c.envs.ua;if(document.addEventListener){if(!/safari/.test(a)){document.addEventListener("DOMContentLoaded",function(){c.startConvert(d)},false)}else{window.addEventListener("load",function(){c.startConvert(d)},false)}}else{if(/msie/.test(a)){try{document.documentElement.doScroll("left")}catch(b){setTimeout(function(){c.init(d)},0);return}c.startConvert(d)}else{window.onload=function(){c.startConvert(d)}}}},startConvert:function(c){var b=h2vconvert;if(!b.styleSet&&b.envs.isIE){h2v_ie.setStyleSheet()}b.styleSet=true;var e;if(b.envs.isOld){for(e in c){if(tyz.getById(e)){b.addBar(e,"最新のブラウザでは縦書きで閲覧できます")}}return false}for(e in c){if(tyz.getById(e)){b.target[e]=new b.h2v(c,e)}}for(e in c){if(tyz.getById(e)){b.ruby_enabler(e);b.target[e].org=tyz.getById(e).cloneNode(true)}}for(e in c){if(!tyz.getById(e)){continue}var d=b.target[e],a=tyz.getById(e);if(d.auto&&!tyz.getByClass(a,"h2v").length){if(d.splash){b.showSplash(e)}(function(h,f,g){setTimeout(function(){try{b.convert(h)}catch(i){b.onErr(f,g)}if(g.splash){b.hideSplash(h)}},1)})(e,a,d)}else{if(d.bar){b.addBar(d.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">横→縦切替</span>")}a.style.visibility="visible"}}},convert:function(k){var c=h2vconvert,n=c.target[k],e=tyz.getById(k),m,l;if(n.converted==""){tyz.setStyles(e,{fontFamily:n.fontSet,fontSize:n.fontsize});if(tyz.getById("b"+k)){tyz.getById("b"+k).parentNode.removeChild(tyz.getById("b"+k))}var h,t=["SCRIPT","STYLE"];for(m=0;m<t.length;m++){h=tyz.getByTag(e,t[m]);for(l=h.length-1;l>=0;l--){e.parentNode.appendChild(h[l])}}if(!c.envs.isIE8){var o=tyz.getByTag(e,"PRE"),a=[];for(m=0;m<o.length;m++){a[m]=o[m].cloneNode(true)}e.innerHTML=e.innerHTML.replace(/[\n\r\t]/g,"");o=tyz.getByTag(e,"PRE");for(m=0;m<o.length;m++){o[m].parentNode.replaceChild(a[m],o[m])}}var q=tyz.getByTag(e,"CENTER"),s;for(m=q.length-1;m>=0;m--){s=tyz.newEle("P",{},{textAlign:"center"});s.appendChild(c.extractNodeContents(q[m]));q[m].parentNode.replaceChild(s,q[m])}e.normalize();n.html=c.extractNodeContents(e);var r=n.chars*n.fsPX;c.tmpdiv=c.createTmpdiv(k);c.tmpdiv.style.height=r+"px";var b=c.separateLines(k,n.html,n.fsPX,r);var g=tyz.newEle("DIV",{},{position:"absolute",left:"0"});for(m=0;m<b.length;m++){g.appendChild(b[m])}n.converted=g.cloneNode(true)}else{var g=n.converted.cloneNode(true);var r=n.chars*n.fsPX;c.tmpdiv=c.createTmpdiv(k)}var f=[];if(!n.multiCols){f[0]=c.oneCol(k,g,r*1+n.fsPX*1)}else{f=c.separateCols(k,g,r*1+n.fsPX*1)}e.innerHTML="";var p;if(n.multiCols){p=tyz.newEle("DIV",{"class":"h2v"},{fontSize:n.fontsize})}else{p=tyz.newEle("DIV",{"class":"h2v"},{fontSize:n.fontsize,direction:"rtl"})}if(n.bar){c.addBar(n.id,"<span onclick=\"h2vconvert.switcher( '"+k+"');\">縦→横切替</span>")}for(m=0;m<f.length;m++){p.appendChild(f[m]);if(m!=f.length-1){p.appendChild(tyz.newEle("DIV",{"class":"h2v_separator"}))}}if(n.showcredit){var d=tyz.newEle("DIV",{"class":"h2v_bar"},{marginTop:"10px",color:n.barForeColor,backgroundColor:n.barBackColor});d.innerHTML='<a href="http://tategaki.info/h2v/" target="_blank">h2v.js '+c.version+"</a>";p.appendChild(d)}n.cols=p.cloneNode(true);e.appendChild(p);e.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"}));c.removeTmpdiv(k);if(e.style.visibility!="visible"){e.style.visibility="visible"}},separateLines:function(a,j,b,i){var m=[],g,d,f=h2vconvert,c=f.target[a];c.mL=0;c.mR=0;var l=i;if(c.flt){l=i-c.fH}while(g=f.seekNodes(a,j,b,l)){if(f.isBlock(g)||f.isList(g)||f.isThru(g)){if(g.className=="h2v_imgFloat_clear"){while(c.fW>0){var h=tyz.round(c.lineSpace*2+b,2);m[m.length]=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:c.lineSpace+"px",marginRight:c.lineSpace+"px",width:b+"px"});c.fW-=h}c.flt=false;l=i}if(f.getDispS(g,["display"],false,a).display=="none"){m[m.length]=tyz.newEle("DIV");m[m.length-1].appendChild(f.extractRange(j,g))}else{if(c.flt){c.fW-=(tyz.PX(g.style.paddingLeft)+tyz.PX(g.style.padingRight)+tyz.PX(g.style.marginLeft)+tyz.PX(g.style.marginRight)+tyz.PX(g.style.width))}m[m.length]=f.extractRange(j,g)}}else{if(c.flt&&c.floatCount==0){c.mL+=c.lineSpace;c.mR+=c.lineSpace;m[m.length]=tyz.newEle("SPAN",{"class":"h2v_imgFloat"},{marginRight:Math.round(c.fW)+"px",marginLeft:"-"+Math.round(c.fW)+"px"});if(c.flt=="right"){m[m.length-1].style.marginTop=l-c.fH+2+"px"}m[m.length-1].appendChild(f.extractRange(j,g))}else{k();d.appendChild(f.extractRange(j,g));m[m.length]=f.setTextAlign(d,l,c,b,0);if(j.hasChildNodes()){var e=j.firstChild;if((f.isInline(e)||e.nodeName=="SPAN")){if(e.innerHTML==""||e.innerHTML==" "){j.removeChild(e)}}}}}c.mL=0;c.mR=0;c.cH=0;if(c.fW>0){l=i-c.fH;c.floatCount++}else{l=i}c.okuri=null}if(j.hasChildNodes()){k();d.appendChild(f.extractNodeContents(j));m[m.length]=f.setTextAlign(d,l,c,b,4)}return m;function k(){c.mL+=c.lineSpace;c.mR+=c.lineSpace;d=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:tyz.round(c.mL,2)+"px",marginRight:tyz.round(c.mR,2)+"px",width:b+"px"});if(c.flt){if(c.floatCount!=0&&c.flt=="left"){d.style.marginTop=c.fH+2+"px"}c.fW-=(b+c.mL+c.mR);if(c.fW<0){c.flt=false;c.floatCount=0}}}},setTextAlign:function(w,u,i,b,f){var j,a,m=h2vconvert;if(w.hasChildNodes()&&w.lastChild.nodeName=="BR"){f=4;if(w.childNodes.length!=1){w.removeChild(w.lastChild)}}switch(i.tAlign+f){case 0:case 4:case 7:return w}j=tyz.newEle("DIV",{},{fontSize:b+"px"});j.appendChild(w);m.tmpdiv.appendChild(j);var p,v=0,r=0,q,g,o,h=0,k=0,n;if(i.tAlign==3){if((p=u-w.offsetHeight)>0){q=w.childNodes;for(g=0;g<q.length;g++){o=q[g];switch(o.nodeName){case"#text":r+=o.nodeValue.length;break;case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":v++;break}}if((h=m.getExtraHeight(p,r))>0){w.style.lineHeight=b+h+"px"}p-=(r*h);if(v>0&&(k=Math.round(p/v))!=0){for(g=0;g<q.length;g++){o=q[g];switch(o.nodeName){case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":o.style.marginBottom=tyz.PX(o.style.marginBottom)+k+"px";break}}}}}else{w.style.marginTop=tyz.PX(w.style.marginTop)+((u-w.offsetHeight)/i.tAlign)+"px"}m.tmpdiv.removeChild(j);return w},getExtraHeight:function(b,a){if(a==0){return 0}return tyz.round((b/a),2)},getExtraHeight_webkit:function(b,a){if(a==0){return 0}return Math.floor(b/a)},Okuri:function(e,d){if(!e){return null}if(e.nodeName=="#document-fragment"){return null}var b,c,a;b=e.nodeName;switch(b){case"#text":if(e.length==0){return this.Okuri(e.previousSibling,d)}if(e.length==1){return e}c=e.splitText(e.length-1);return e;case"SPAN":a=tyz.getAttr(e,"class");if(/h2v_kuto|h2v_kakko_b|h2v_tcy/.test(a)){d++;if(d>=3){return null}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}if(/h2v_sp|h2v_cho|h2v_komoji/.test(a)){return e.previousSibling||this.addBlank(e)}if(/h2v_alpha/.test(a)){if(/okurare/.test(a)){d++;if(d>=3){return e}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}return null}return this.Okuri(e.lastChild,d)||e.lastChild||this.addBlank(e);case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return this.Okuri(e.lastChild,d)||e.lastChild||this.addBlank(e);case"RUBY":a=tyz.getAttr(e,"class");if(/okurare/.test(a)){d++;if(d>=3){return e}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}return null}return null},addBlank:function(b){var a=document.createTextNode("");b.parentNode.insertBefore(a,b);return a},seekNodes:function(I,C,v,R){var z=C.firstChild,h,a=h2vconvert,L=a.target[I],U,w=0,p=0,F=0;for(U=0;U<C.childNodes.length;U++){z=C.childNodes[U];h=z.nodeName;if(h=="SPAN"){h=a.getSpanFlag(z)}var P;if(h=="#text"&&!(a.span_match(C,/h2v_/))&&z.nodeValue!=""){a.addVTags(z);z=C.childNodes[U];h=z.nodeName;if(h=="SPAN"){h=a.getSpanFlag(z)}}switch(h){case"#text":p=v*z.length;if(p==0){break}F=R-L.cH;if(F<=0){F=0}L.cH+=p;if(tyz.ceil(F,2)<=tyz.floor(p,2)){var W=Math.floor(F/v);if(W==0){return L.okuri||z.previousSibling||a.addBlank(z)}else{if(W<z.length){P=z.splitText(W);return z}}}break;case 1:case 5:if(L.okuri){return L.okuri}if((R-(L.cH-v))/v<1){L.okuri=a.Okuri(z.previousSibling,0)||z.previousSibling||a.addBlank(z)}L.cH+=v;break;case 2:L.cH+=v;if(R-L.cH<=1){return L.okuri||z.previousSibling||a.addBlank(z)}break;case 3:L.cH+=v;if(R-L.cH<0){return L.okuri||z.previousSibling||a.addBlank(z)}break;case 4:case 6:var p=tyz.PX(a.getDispS(z,["width"],true,I,false).width);L.cH+=p;if(!z.done_h2v){tyz.setStyles(z,{width:p+"px",marginBottom:Math.ceil(p-v)+"px"})}if(R-L.cH<0){if(z.done_h2v){return z}if(z.previousSibling){z.done_h2v=true;return z.previousSibling}else{if(a.isList(C)||C.nodeName=="SPAN"){z.done_h2v=true;return a.addBlank(z)}}}if(p<=v){z.className="okurare "+z.className}break;case 7:case"RB":case"RT":case"RTC":case"RBC":w=L.cH;a.seekNodes(I,z,v,1000);L.cH=w;if(z.style.MozTransform){z.style.MozTransform=null}break;case 0:case 8:case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":if(L.okuri&&R-L.cH<0){return L.okuri}var d=a.getNewProp(z,I,true),j=d.ds,x=tyz.PX(j.fontSize);d.s.marginLeft=(-x-tyz.PX(j.paddingTop)-tyz.PX(j.paddingBottom)-tyz.PX(j.borderTopWidth)-tyz.PX(j.borderBottomWidth))/2+"px";if(h==8){d.s.marginLeft=tyz.PX(d.s.marginLeft)+tyz.PX(j.borderTopWidth)/2+"px"}var r=R-tyz.PX(j.marginLeft)-tyz.PX(j.paddingLeft)-tyz.PX(j.borderLeftWidth);if(r<=0){r=x}a.setLineMargin(I,x,j);var q=a.seekNodes(I,z,x,r);if(q){var D=z.cloneNode(false),f=a.extractRange(z,q);D.appendChild(f);tyz.setStyles(D,d.s);D.done_h2v=true;tyz.setStyles(D,{marginBottom:0,paddingBottom:0,borderBottomWidth:0});tyz.setStyles(z,{marginLeft:0,paddingLeft:0,borderLeftWidth:0});z.parentNode.insertBefore(D,z);return D}L.cH+=d.xm*1;if(!z.done_h2v){tyz.setStyles(z,d.s)}z.done_h2v=true;break;case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"LI":case"DT":case"DD":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":if(L.fW>0){var Q=tyz.getStyle(z,"clear")||a.getDispS(z,["clear"],false,I);if(Q&&Q!="none"){return t()}}var d=a.getNewProp(z,I),j=d.ds,x=tyz.PX(j.fontSize);if(j.position!="static"){z.style.position="static"}var A=L.tAlign;switch(j.textAlign){case"justify":L.tAlign=3;break;case"center":L.tAlign=2;break;case"right":L.tAlign=1;break;case"left":default:L.tAlign=0;break}var y=tyz.PX(j.width),J=tyz.PX(j.height);R=y==0?R:y;d.xm=y==0?d.xm:0;var r=R-d.xm;if(r<=0){r=x}a.setLineMargin(I,x);var E=a.separateLines(I,z,x,r);tyz.setStyles(z,d.s);z.style.width=J==0?"auto":J+"px";if(y==0){z.style.height="auto"}else{z.style.height=null;z.style.minHeight=y+"px"}for(var N=0;N<E.length;N++){z.appendChild(E[N])}if(h=="LI"){var l=tyz.newEle("SPAN",{"class":"h2v_mark"});l.appendChild(document.createTextNode("・"));z.children[0].insertBefore(l,z.children[0].firstChild)}L.tAlign=A;return z;break;case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":var j=a.getDispS(z,["width","marginTop","marginBottom","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],true,I,true),K=tyz.PX(j.marginLeft)+"px "+tyz.PX(j.marginTop)+"px "+tyz.PX(j.marginRight)+"px "+tyz.PX(j.marginBottom)+"px";tyz.setStyles(z,{margin:K,paddingLeft:tyz.PX(j.paddingLeft)+"px",paddingRight:tyz.PX(j.paddingRight)+"px",borderLeftWidth:tyz.PX(j.borderLeftWidth)+"px",borderRightWidth:tyz.PX(j.borderRightWidth)+"px",width:tyz.PX(j.width)+"px",maxWidth:tyz.PX(j.width)+"px"});if(L.flt=="left"&&L.fW>0){tyz.setStyles(z,{paddingTop:L.fH+"px"})}return z;break;case"RUBY":if(z.done_h2v){delete z.done_h2v;var b=(a.envs.isIE8)?tyz.PX(z.style.height):tyz.PX(a.getDispS(z,["height"],true,I).height),m=tyz.floor(v*0.7,2);L.cH+=b;if(L.mR-m<0){L.mR=m-v*(L.lineInterval/2)}if(R-L.cH<0){if(R-b>0){return z.previousSibling||a.addBlank(z)}return z}break}z=this.ruby_to_html4_style(z);w=L.cH;a.seekNodes(I,z,v,1000);L.cH=w;var b,S,M,c,B,k,n,s=0,G,O,V;z.style.fontSize=v+"px";var X=tyz.newEle("SPAN",{"class":"h2v_e"});var e=z.cloneNode(true);X.appendChild(e);a.tmpdiv.appendChild(X);b=e.offsetHeight;S=e.offsetWidth;O=tyz.getByTag(e,"RBC");if(O.length==0){M=tyz.getByTag(e,"RB");c=M[0].offsetHeight;if(b-c>0){M[0].style.lineHeight=Math.floor(b*v/c)+"px"}}else{V=tyz.getByTag(z,"RTC");if(V.length==0){break}M=tyz.getByTag(O[0],"RB"),B=tyz.getByTag(V[0],"RT");if(M.length!=B.length){break}for(G=0;G<M.length;G++){c=M[G].offsetHeight;k=B[G].offsetHeight;n=c-k>0?c:k;s+=s;if(c-n<0){tyz.setStyles(M[G],{marginTop:(n-c)/2+"px",height:c*1+(n-c)/2+"px"})}if(k-n<0){tyz.setStyles(B[G],{marginTop:(n-k)/2+"px",height:k*1+(n-k)/2+"px"})}}}a.tmpdiv.removeChild(X);z.style.height=b+"px";b=b-s>0?b:s;L.cH+=b;if(R-L.cH<0){if(z.previousSibling){z.done_h2v=true;return z.previousSibling}else{if(a.isList(C)||C.nodeName=="SPAN"){z.done_h2v=true;return a.addBlank(z)}}}if(b<=v){z.className="okurare "+z.className}z.done_h2v=true;var m=(S-v);if(L.mR-m<0){L.mR=m-v*(L.lineInterval/2)}break;case"IMG":var j=a.getDispS(z,["width","height","marginLeft","marginRight","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","marginTop","marginBottom","cssFloat"],true,I),p,g;if(a.envs.isIE8){j.height=tyz.PX(h2v_ie.getOH(z))-tyz.PX(j.paddingTop)-tyz.PX(j.paddingBottom)-tyz.PX(j.borderTopWidth)-tyz.PX(j.borderBottomWidth)}p=tyz.PX(j.height)+tyz.PX(j.paddingTop)+tyz.PX(j.paddingBottom)+tyz.PX(j.marginTop)+tyz.PX(j.marginBottom)+tyz.PX(j.borderTopWidth)+tyz.PX(j.borderBottomWidth);g=tyz.PX(j.width)-L.fsPX+tyz.PX(j.paddingLeft)+tyz.PX(j.paddingRight)+tyz.PX(j.borderLeftWidth)+tyz.PX(j.borderRightWidth);j.maxWidth=j.width;j.maxHeight=j.height;if(z.done_h2v){o();return z}if((j.cssFloat=="left"||j.cssFloat=="right")&&R-p>v){if(L.flt){return t()}L.flt=j.cssFloat;j.cssFloat="none";tyz.setStyles(z,j);L.fH=p;L.fW=tyz.round((tyz.PX(j.width)+tyz.PX(j.paddingLeft)+tyz.PX(j.paddingRight)+tyz.PX(j.borderLeftWidth)+tyz.PX(j.borderRightWidth)+tyz.PX(j.marginLeft)+tyz.PX(j.marginRight)),2);L.floatCount=0;return z}j.cssFloat="none";tyz.setStyles(z,j);if(R-p<0&&z.previousSibling){z.done_h2v=true;return z.previousSibling}L.cH+=p;if(R-L.cH<0&&z.previousSibling){return z.previousSibling}o();break;case"BR":return L.okuri||z;case"HR":if(!z.done_h2v){z.done_h2v=true;z.style.height=tyz.PX(L.pageheight)*0.8+"px";return L.okuri||z.previousSibling||a.addBlank(z)}else{return z}default:var q=a.seekNodes(I,z,v,R);if(q){return q}break}if(z.nextSibling){var T=z.nextSibling;if(a.isBlock(T)||a.isThru(T)){return L.okuri||z}}}return L.okuri||false;function o(){if(g!=0){g=(g+tyz.PX(j.width))/2;L.mR=g+tyz.PX(j.marginRight)}}function t(){var i=tyz.newEle("DIV",{"class":"h2v_imgFloat_clear"});z.parentNode.insertBefore(i,z);return i}},getSpanFlag:function(b){var a=tyz.getAttr(b,"class");if(/h2v_kuto|h2v_kakko_b/.test(a)){return 1}if(/h2v_kakko_t/.test(a)){return 2}if(/h2v_cho|h2v_komoji|h2v_rotate/.test(a)){return 3}if(/h2v_sp/.test(a)){return 4}if(/h2v_tcy/.test(a)){return 5}if(/h2v_alpha/.test(a)){return 6}if(/psdo_r/.test(a)){return 7}if(/bousen_/.test(a)){return 8}return 0},oneCol:function(h,f,g){this.tmpdiv.appendChild(f);var b=f.offsetWidth+1,e=f.offsetHeight,d=tyz.PX(this.target[h].pagewidth)-3;if(d>b){b=d;f.style.width=b+"px"}var a=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:b+"px"});a.appendChild(f);var c=tyz.newEle("DIV",{"class":"h2v_oc"},{width:d+"px",height:e+15+"px",minHeight:g+"px"});c.appendChild(a);return c},separateCols:function(k,l,r){var h=[],f=tyz.PX(this.target[k].pagewidth),j,o;l.normalize();o=document.createDocumentFragment();o.appendChild(l);i();a("PRE");a("TABLE");var d,t,u,q,b=0,p=0,m,c,v=0;while(1){u=0;j=f+Math.ceil(p);d=g(l);if(d===null){break}t=Math.ceil(b+p+5);if(u-f>0){u=f}q=(p<=0?"0":"-"+Math.floor(p))+"px";m=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:t+"px",right:q});m.appendChild(this.extractRange(l,d.cnt));c=this.envs.isIE8?h2v_ie.getOH(m):this.getDispS(m,["height"],true,k,true).height;h[h.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:u+"px",minHeight:r+"px",height:c});h[h.length-1].appendChild(m);b=0;p=v;v=0}q=(p<=0?0:"-"+Math.floor(p))+"px";t=Math.ceil(b+p+5);m=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:t+"px",right:q});m.appendChild(this.extractNodeContents(l));c=this.envs.isIE8?h2v_ie.getOH(m):this.getDispS(m,["height"],true,k,true).height;h[h.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:j+"px",minHeight:r+"px",height:c});h[h.length-1].appendChild(m);return h;var e,s;function g(A){var H=A.childNodes,D,B={},z,E,F;for(D=0;D<H.length;D++){if(H[D].nodeName=="#text"){continue}if(!H[D].style){continue}E=H[D].style;B.mR=tyz.PX(E.marginRight);B.bR=tyz.PX(E.borderRightWidth);B.pR=tyz.PX(E.paddingRight);B.w=tyz.PX(E.width);B.pL=tyz.PX(E.paddingLeft);B.bL=tyz.PX(E.borderLeftWidth);B.mL=tyz.PX(E.marginLeft);z=B.mR+B.bR+B.pR+B.w+B.pL+B.bL;if(h2vconvert.isThru(H[D])||h2vconvert.span_match(H[D],"h2v_e")||h2vconvert.isInline(H[D])||(h2vconvert.isBlock(H[D])&&!H[D].hasChildNodes())){b+=z;if(b-j>0){if(z-f>=0){b+=B.mL;u=b-p;return{cnt:H[D],desc:"e"}}b-=z;u=b-p;if(e){e.style.marginRight=s-b+"px";e.style.marginLeft=-(s-b)+"px";H[D].parentNode.insertBefore(e.cloneNode(true),H[D]);e=null}return{cnt:H[D].previousSibling||h2vconvert.addBlank(H[D]),desc:"e"}}b+=B.mL;continue}else{if(h2vconvert.span_match(H[D],"h2v_imgFloat")){var G=b+z;if(G-j>0){s=G;e=H[D].cloneNode(true)}continue}}var x=b*1;b+=B.mR;if(b-j>0){v=j-x;F=H[D].cloneNode(false);H[D].parentNode.insertBefore(F,H[D]);b+=B.bR+B.pR+B.w+B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}b+=B.bR+B.pR;if(b-j>0){v=j-x;F=H[D].cloneNode(false);H[D].parentNode.insertBefore(F,H[D]);b+=B.w+B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}var w=b*1,C=g(H[D]),y=b-w;if(y-Math.round(B.w)<0){y=B.w}if(C===null){b=w+y;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);b+=B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}b+=B.pL+B.bL;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);b+=B.mL;u=f;return{cnt:F,desc:""}}b+=B.mL;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);u=f;return{cnt:F,desc:""}}continue}b+=y+B.pL+B.bL+B.mL;if(C.desc=="e"&&B.w!=0){F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);C.cnt=F;C.desc="";v=b-x}else{v+=B.mR+B.bR+B.pR}return C}return null}function n(x,w){while(1){if(x.nodeName=="#document-fragment"){return false}if(tyz.getAttr(x,"class")==w){return x}x=x.parentNode}}function i(){var y=tyz.getByTag(l,"IMG"),x,F,C,D,A=0,E=0,z=0,w=0,B=0;for(C=0;C<y.length;C++){x=n(y[C].parentNode,"h2v_e");if(x===false){continue}D=x.style;A=tyz.PX(D.width)+tyz.PX(D.marginLeft)+tyz.PX(D.marginRight)+tyz.PX(D.paddingLeft)+tyz.PX(D.paddingRight)+tyz.PX(D.borderLeftWidth)+tyz.PX(D.borderRightWidth);if(A-f>0){E=tyz.PX(y[C].style.width);z=tyz.PX(y[C].style.height);if(h2vconvert.envs.isIE8){z=tyz.PX(h2v_ie.getOH(y[C]))}w=E-(A-f);if(w>0){B=z*w/E;tyz.setStyles(y[C],{width:w+"px",height:B+"px"});x.style.marginRight=tyz.PX(D.marginRight)-(A-f)+"px"}}}}function a(x){var w=tyz.getByTag(l,x),z=0,B,y=0,A=0;for(z=0;z<w.length;z++){B=w[z].style;y=tyz.PX(B.width)+tyz.PX(B.paddingLeft)+tyz.PX(B.paddingRight)+tyz.PX(B.marginRight)+tyz.PX(B.marginLeft)+tyz.PX(B.borderLeftWidth)+tyz.PX(B.borderRightWidth);if(y-f>0){A=tyz.PX(B.width)-(y-f);if(A>0){w[z].style.width=A+"px"}}}}},addVTags:function(c){var k=c.cloneNode(true);k.nodeValue=k.nodeValue.replace(this.orig_ex,function(j){return h2vconvert.repl_a[j]});result=[],cname=[],place=[],plength=[];while(result=this.ptn.exec(k.nodeValue)){if(result[1]){cname[cname.length]="h2v_komoji"}else{if(result[2]){cname[cname.length]="h2v_cho"}else{if(result[3]){cname[cname.length]="h2v_kuto"}else{if(result[4]){cname[cname.length]="h2v_sp"}else{if(result[5]){cname[cname.length]="h2v_alpha"}else{if(result[6]){cname[cname.length]="h2v_kakko_t_nr"}else{if(result[7]){cname[cname.length]="h2v_kakko_b_nr"}else{if(result[8]){cname[cname.length]="h2v_kakko_t"}else{if(result[9]){cname[cname.length]="h2v_kakko_b"}else{if(result[10]){cname[cname.length]="h2v_rotate"}else{if(result[11]){cname[cname.length]="h2v_kuto_s"}}}}}}}}}}}plength[plength.length]=result[0].length;place[place.length]=this.ptn.lastIndex-result[0].length}var i,d,a,b,e,g=document.createDocumentFragment();g.appendChild(k);for(e=cname.length-1;e>=0;e--){i=k.splitText(place[e]+plength[e]);d=k.splitText(place[e]);a=tyz.newEle("SPAN",{"class":cname[e]});b=document.createTextNode(d.nodeValue);a.appendChild(b);g.replaceChild(a,d)}var f;if(this.envs.isIE8){var h=tyz.newEle("DIV");h.appendChild(g.cloneNode(true));h.normalize();g=document.createDocumentFragment();g.appendChild(h2vconvert.extractNodeContents(h))}else{g.normalize()}while(g.firstChild){c.parentNode.insertBefore(g.firstChild,c)}c.parentNode.removeChild(c)},resizeTimer:null,resizeFlag:false,resizeW:0,doresize:function(){if(!h2vconvert.resizeFlag){h2vconvert.resizeFlag=true;h2vconvert.resizeTimer=setInterval(function(){if(h2vconvert.resizeW==window.innerWidth){clearInterval(h2vconvert.resizeTimer);h2vconvert.resizing();setTimeout(function(){h2vconvert.resizeFlag=false},1)}else{h2vconvert.resizeW=window.innerWidth;return false}},100)}else{return false}},resizing:function(){var c=h2vconvert,a,e,d,b;for(d in c.target){a=tyz.getById(d);if(tyz.getByClass(a,"h2v").length==0){return false}e=c.target[d];b=tyz.getById(d).offsetWidth-tyz.getPxStyle(a,"paddingLeft")-tyz.getPxStyle(a,"paddingRight")-tyz.getPxStyle(a,"borderLeftWidth")-tyz.getPxStyle(a,"borderRightWidth");if(c.reConvert(e,b)){(function(h,f,g){setTimeout(function(){try{h2vconvert.convert(h)}catch(i){h2vconvert.onErr(f,g)}},1)})(d,a,e)}}},reConvert:function(b,a){if(!b.cols){if(b.fixedwidth&&Math.round(tyz.PX(b.fixedwidth))<=a){b.pagewidth=b.fixedwidth}else{b.pagewidth=a+"px"}return true}else{if(b.fixedwidth&&Math.round(tyz.PX(b.fixedwidth))<=a){if(b.pagewidth==b.fixedwidth){return false}else{b.pagewidth=b.fixedwidth;return true}}else{if(Math.round(tyz.PX(b.pagewidth))==a){return false}else{b.pagewidth=a+"px";return true}}}},getNewProp:function(i,b,h){var c=h2vconvert.getDispS(i,["fontSize","width","height","marginTop","marginLeft","marginBottom","marginRight","paddingTop","paddingLeft","paddingBottom","paddingRight","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","textAlign","position","display"],h,b),g=tyz.PX(c.marginLeft)+tyz.PX(c.marginRight)+tyz.PX(c.paddingLeft)+tyz.PX(c.paddingRight)+tyz.PX(c.borderLeftWidth)+tyz.PX(c.borderRightWidth),f=tyz.PX(c.marginLeft)+"px "+tyz.PX(c.marginTop)+"px "+tyz.PX(c.marginRight)+"px "+tyz.PX(c.marginBottom)+"px",j=tyz.PX(c.paddingLeft)+"px "+tyz.PX(c.paddingTop)+"px "+tyz.PX(c.paddingRight)+"px "+tyz.PX(c.paddingBottom)+"px",a={margin:f,padding:j,fontSize:tyz.PX(c.fontSize)+"px"},e=this.rotateBdr({Top:c.borderTopStyle,Right:c.borderRightStyle,Bottom:c.borderBottomStyle,Left:c.borderLeftStyle},i,b);for(var d in e){a[d]=e[d]}return{s:a,xm:g,ds:c}},rotateBdr:function(a,f,h){var e={};for(var g in a){if(a[g]&&a[g]!="none"){e["border"+c(g)+"Style"]=a[g];var b=[];b.push("border"+g+"Width","border"+g+"Color");var d=this.getDispS(f,b,false,h);e["border"+c(g)+"Width"]=d["border"+g+"Width"];e["border"+c(g)+"Color"]=d["border"+g+"Color"]}else{e["border"+c(g)+"Style"]="none";e["border"+c(g)+"Width"]="0"}}return e;function c(j){var i={Top:"Right",Right:"Bottom",Bottom:"Left",Left:"Top"};return i[j]}},setLineMargin:function(f,a,c){var e=this.target[f];if(c){a+=(tyz.PX(c.marginTop)+tyz.PX(c.marginBottom)+tyz.PX(c.paddingTop)+tyz.PX(c.paddingBottom))/2}if(e.fsPX-a<0){var d=(a-e.fsPX)/2;if(e.mL-d<0){e.mL=d}var b=(a-e.fsPX)/2;if(e.mR-b<0){e.mR=b}}},addBar:function(d,c){var a="b"+d,b=tyz.getById(a)||tyz.newEle("DIV",{"class":"h2v_bar",id:a},{color:this.target[d].barForeColor,backgroundColor:this.target[d].barBackColor});b.innerHTML=c;tyz.getById(d).insertBefore(b,tyz.getById(d).firstChild)},showSplash:function(c){var a=tyz.getById(c),b=tyz.newEle("DIV",{"class":"h2v_splash",id:"sp"+c},{top:a.offsetTop*1+15+"px",left:a.offsetLeft+"px",width:a.offsetWidth-58+"px"});b.innerHTML="縦書きレイアウトに変換しています…";a.parentNode.appendChild(b);a.style.opacity="0.5";if(this.envs.isIE8){a.style.filter="alpha(opacity=50)"}},hideSplash:function(c){var b=tyz.getById("sp"+c),a=tyz.getById(c).style;a.opacity=this.target[c].orgOpacity;if(this.envs.isIE8){a.filter=this.target[c].orgOpacity}if(!b){return}b.style.opacity="0";setTimeout(function(){b.parentNode.removeChild(b)},500)},onErr:function(a,b){a.innerHTML="";a.parentNode.replaceChild(b.org.cloneNode(true),a);this.addBar(b.id,'<a href="http://tategaki.info/h2v/" target="_blank">h2v.js Failed!</a>');tyz.setStyles(tyz.getById(b.id),b.orgStyles)},isBlock:function(a){switch(a.nodeName){case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":return true;default:return false}},isList:function(a){switch(a.nodeName){case"LI":case"DT":case"DD":return true;default:return false}},isInline:function(a){switch(a.nodeName){case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return true;default:return false}},isThru:function(a){switch(a.nodeName){case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":return true;default:return false}},span_match:function(a,b){if(a.nodeName=="SPAN"&&tyz.getAttr(a,"class").match(b)){return true}return false},getDispS:function(a,b,k,e,h){var m=a.cloneNode(k),f=a.parentNode,i=0,g,n,l,c,j;while(f&&f.nodeName!="#document-fragment"){g=f.cloneNode(false);g.appendChild(m);m=g;i++;f=f.parentNode}if(h){n=m.cloneNode(k);this.tmpdiv.appendChild(n)}else{l=tyz.newEle("DIV",{id:"h2v_tmp_sq"},{height:this.target[e].pageheight,width:this.target[e].pageheight});n=m.cloneNode(true);l.appendChild(n);this.tmpdiv.appendChild(l)}for(j=0;j<i;j++){n=n.lastChild}c=tyz.getStyles(n,b);this.tmpdiv.removeChild(this.tmpdiv.lastChild);return c},createTmpdiv:function(d){if(!tyz.getById("h2v_tmp_div")){var c=this.target[d].orgHeight*tyz.getById(d).offsetWidth*tyz.PX(this.target[d].orgStyles.fontSize)/(this.target[d].chars*tyz.PX(this.target[d].fontsize)),b=Math.ceil(c*(1+(this.target[d].lineInterval)*2)),a=tyz.newEle("DIV",{id:"h2v_tmp_div","class":"h2v"},{width:b+"px",fontSize:this.target[d].fontsize,fontFamily:this.target[d].fontSet});tyz.getById(d).appendChild(a);return a}else{return tyz.getById("h2v_tmp_div")}},removeTmpdiv:function(a){if(tyz.getById("h2v_tmp_div")){tyz.getById(a).removeChild(tyz.getById("h2v_tmp_div"))}},rubyEnabled:false,ruby_enabler:function(p){setTimeout(function(){h2vconvert.rubyEnabled=true},1);var o=h2vconvert.envs,u=o.ua,t,s,q,y,w,m=tyz.getByTag(tyz.getById(p),"RUBY");if(/webkit/.test(u)||o.isIE){var d,l,r,e;for(t=m.length-1;t>=0;t--){m[t].normalize();d=tyz.getByTag(m[t],"RBC");l=tyz.getByTag(m[t],"RTC");if(d.length!=l.length){continue}r=tyz.getByTag(m[t],"RB");e=tyz.getByTag(m[t],"RT");w=document.createDocumentFragment();if(r.length!=0){for(s=0;s<r.length;s++){y=tyz.newEle("RUBY");y.appendChild(document.createTextNode(r[s].innerHTML));y.appendChild(e[s].cloneNode(true));w.appendChild(y.cloneNode(true))}}else{for(s=0;s<e.length;s++){y=tyz.newEle("RUBY");y.appendChild(e[s].previousSibling.cloneNode(true));y.appendChild(e[s].cloneNode(true));w.appendChild(y.cloneNode(true))}}m[t].parentNode.replaceChild(w,m[t])}return}var b,c,n,g,e,r,l;for(t=m.length-1;t>=0;t--){m[t].innerHTML=m[t].innerHTML.replace(/[\n\r\t]/g,"");m[t].normalize();b=document.defaultView.getComputedStyle(m[t],null);c=b.fontSize.replace("px","");n=b.lineHeight.replace("px","");g=(n-c)/2-2;g=g<=0?0:g;e=tyz.getByTag(m[t],"RT");r=tyz.getByTag(m[t],"RB");l=tyz.getByTag(m[t],"RTC");if(l.length==0){var x,a,f,v;if(e.length<2){x=document.createDocumentFragment();a=document.createDocumentFragment()}else{x=tyz.newEle("RBC");a=tyz.newEle("RTC")}for(s=0;s<m[t].childNodes.length;s++){f=m[t].childNodes[s];switch(f.nodeName){case"#text":v=tyz.newEle("RB");v.appendChild(f.cloneNode(true));x.appendChild(v);break;case"RB":x.appendChild(f.cloneNode(true));break;case"RT":a.appendChild(f.cloneNode(true));if(g){a.lastChild.style.MozTransform="translate(0,"+g+"px)"}break}}w=document.createDocumentFragment();for(q=0;q<x.childNodes.length;q++){y=tyz.newEle("RUBY");y.appendChild(x.childNodes[q].cloneNode(true));y.appendChild(a.childNodes[q].cloneNode(true));w.appendChild(y.cloneNode(true))}m[t].parentNode.replaceChild(w,m[t])}else{w=document.createDocumentFragment();for(q=0;q<r.length;q++){y=tyz.newEle("RUBY");y.appendChild(r[q].cloneNode(true));y.appendChild(e[q].cloneNode(true));w.appendChild(y.cloneNode(true))}m[t].parentNode.replaceChild(w,m[t]);if(g){l[0].style.MozTransform="translate(0,"+g+"px)"}}}if(!h2vconvert.rubyEnabled){var h=tyz.newEle("STYLE");h.innerHTML="ruby{display:inline-table;text-align:center !important ;text-indent:0 !important;margin:0 !important;padding:0 !important;vertical-align:bottom}\nruby>rb,ruby>rbc{display:table-row-group;}\nruby>rt,ruby>rtc{display:table-header-group;font-size:8px;line-height:1em;letter-spacing:0 !important;font-weight:normal !important;font-style:normal !important;}\nrbc>rb{display:table-cell;}\nrtc>rt{display:table-cell;letter-spacing:0 !important;line-height:1em;}\nrp{display:none !important;}\n";if(/opera/gi.test(u)){h.innerHTML+="ruby,ruby>rb,ruby>rbc,ruby>rt,ruby>rtc,rbc>rb,rtc>rb{line-height:1em;}\nruby{vertical-align:0.95em;}\n"}tyz.getByTag(document,"HEAD")[0].appendChild(h)}return},ruby_to_html4_style:function(l){var h=h2vconvert,g=tyz.newEle("RUBY"),d,e,b,a,n;d=tyz.getByTag(l,"RT");e=tyz.getByTag(l,"RBC");b=tyz.getByTag(l,"RTC");if(b.length==0){var m,k,c,j;if(d.length<2){m=document.createDocumentFragment();k=document.createDocumentFragment()}else{m=tyz.newEle("RBC");k=tyz.newEle("RTC")}for(var f=0;f<l.childNodes.length;f++){c=l.childNodes[f];switch(c.nodeName){case"#text":c.nodeValue=c.nodeValue.replace(/^\s+|\s+$/,"");j=tyz.newEle("RB");j.appendChild(c.cloneNode(true));j.innerHTML='<span class="psdo_r_inner">'+j.innerHTML+"</span>";m.appendChild(j);break;case"RB":j=c.cloneNode(true);j.innerHTML='<span class="psdo_r_inner">'+j.innerHTML+"</span>";m.appendChild(j);break;case"RT":j=c.cloneNode(true);j.innerHTML='<span class="psdo_r_inner">'+j.innerHTML+"</span>";k.appendChild(j);break}}g.appendChild(m);g.appendChild(k);l.parentNode.replaceChild(g,l);return g}else{if(e.length!=0){return l}throw new Error()}throw new Error()},h2v:function(g,h){this.id=h;var c=g[h],f=h2vconvert,a,e,b;for(a in f.defaultval){this[a]=f.defaultval[a]}for(a in c){this[a]=c[a]}e=tyz.getById(h);b=e.offsetWidth-tyz.getPxStyle(e,"paddingLeft")-tyz.getPxStyle(e,"paddingRight")-tyz.getPxStyle(e,"borderLeftWidth")-tyz.getPxStyle(e,"borderRightWidth");this.pagewidth=c.pagewidth!==undefined?c.pagewidth:(b+"px");this.fixedwidth=c.pagewidth!==undefined?c.pagewidth:false;if(tyz.PX(this.pagewidth)>b){this.pagewidth=b+"px"}this.fsPX=tyz.PX(this.fontsize);this.pageheight=this.chars*this.fsPX+"px";this.mR=0;this.mL=0;this.lineSpace=Math.round(this.fsPX*this.lineInterval/2);this.cH=0;this.tAlign=0;this.org=document.createDocumentFragment();this.org.appendChild(e.cloneNode(true));this.orgStyles=tyz.getStyles(e,["fontSize","fontFamily"]);this.orgStyles.visibility="visible";this.orgHeight=e.offsetHeight;this.orgOpacity=f.envs.isIE8?tyz.getStyle(e,"msFilter"):tyz.getStyle(e,"opacity");this.okuri=null;this.html="";this.converted="";if(this.fontSet.toLowerCase()=="mincho"){this.fontSet=f.fontSet.mincho}else{this.fontSet=f.fontSet.gothic}this.flt=false;this.floatCount=0;this.justify=false},extractRange:function(a,b){var c=document.createRange();c.setStartBefore(a.firstChild);c.setEndAfter(b);return c.extractContents()},extractNodeContents:function(b){var a=document.createRange();a.selectNodeContents(b);return a.extractContents()},switcher:function(e){var d=this.target[e],a=tyz.getById(e);if(tyz.getByClass(a,"h2v").length){a.innerHTML="";a.parentNode.replaceChild(d.org.cloneNode(true),a);a=tyz.getById(e);if(d.bar){this.addBar(d.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">横→縦切替</span>")}tyz.setStyles(a,d.orgStyles)}else{var b=a.offsetWidth-tyz.getPxStyle(a,"paddingLeft")-tyz.getPxStyle(a,"paddingRight")-tyz.getPxStyle(a,"borderLeftWidth")-tyz.getPxStyle(a,"borderRightWidth");if(this.reConvert(d,b)){if(d.splash){this.showSplash(e)}(function(h,f,g){setTimeout(function(){try{h2vconvert.convert(h)}catch(i){h2vconvert.onErr(f,g)}if(g.splash){h2vconvert.hideSplash(h)}},1)})(e,a,d)}else{try{a.innerHTML="";if(d.bar){this.addBar(d.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">縦→横切替</span>")}a.style.fontFamily=d.fontSet;a.appendChild(d.cols.cloneNode(true));a.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"}))}catch(c){this.onErr(a,d)}}}},komojis:["ぁ","ぃ","ぅ","ぇ","ぉ","っ","ゃ","ゅ","ょ","ゎ","ァ","ィ","ゥ","ェ","ォ","ッ","ャ","ュ","ョ","ヮ"].join(""),kakko_t_kagi_a:["「","『"],kakko_t_kagi_r_a:["﹁","﹃"],kakko_t_a:["（","｛","〈","《","〔","【"],kakko_t_r_a:["︵","︷","︿","︽","︹","︻"],kakko_b_kagi_a:["」","』"],kakko_b_kagi_r_a:["﹂","﹄"],kakko_b_a:["）","｝","〉","》","〕","】"],kakko_b_r_a:["︶","︸","﹀","︾","︺","︼"],dash_a:["―","—","‥","ー"],dash_r_a:["︱","︱","︰","丨"],kakkos_tr:["［","〘"].join(""),kakkos_br:["］","〙"].join(""),rotates:["↑","↓","→","←","…","＝","−","：","；","＜","＞"].join(""),rotate_mirrors:["〜","～"].join(""),kutos:["。","、","，"].join(""),orig_ex:null,repl_a:[],ptn:null};var tyz={getByClass:function(d,a){if(d.getElementsByClassName){return d.getElementsByClassName(a)}else{var e=tyz.getByTag(d,"*"),b=[];for(var c=0;c<e.length;c++){if(tyz.getAttr(e[c],"class")==a){b[b.length]=e[c]}}return b}},getById:function(a){return document.getElementById(a)},getByTag:function(b,a){return b.getElementsByTagName(a)},getStyle:function(a,b){return document.defaultView.getComputedStyle(a,null)[b]},getStyles:function(c,e){var b=document.defaultView.getComputedStyle(c,null),d={};for(var a=0;a<e.length;a++){d[e[a]]=b[e[a]]}return d},getAttr:function(b,a){return b.getAttribute(a)||""},PX:function(a){a+="";if(a==""){return 0}if(a.match("px")){return tyz.round(a.replace("px","")*1,2)}if(a.match("pt")){return tyz.round(a.replace("pt","")*4/3,2)}if(a.match("em")){return tyz.round(a.replace("em","")*h2vconvert.defaultFS*1,2)}if(a.match(/[^0-9\.]/g)){return 0}return tyz.round(a*1,2)},getPxStyle:function(b,c){var a=document.defaultView.getComputedStyle(b,null);return this.PX(a[c])},setStyles:function(c,b){for(var a in b){c.style[a]=b[a]}return c},newEle:function(d,c,f){var g=document.createElement(d),b,e;for(b in c){g.setAttribute(b,c[b])}for(e in f){g.style[e]=f[e]}return g},round:function(c,b){var a=Math.pow(10,b);return Math.round(c*a)/a},ceil:function(c,b){var a=Math.pow(10,b);return Math.ceil(c*a)/a},floor:function(c,b){var a=Math.pow(10,b);return Math.floor(c*a)/a}};var h2v_ie={getStyle:function(a,b){if(h2v_ie.checkVal_w(b)||h2v_ie.checkVal_h(b)){return h2v_ie.getSize(a,b)+"px"}if(b=="fontSize"){return h2v_ie.getFontSize(a)+"px"}if(b=="cssFloat"){return a.currentStyle.styleFloat}return a.currentStyle[b]},getStyles:function(b,d){var c={},a;for(a=0;a<d.length;a++){c[d[a]]=h2v_ie.getStyle(b,d[a])}return c},getPxStyle:function(a,c){var b=h2v_ie.getStyle(a,c);return tyz.PX(b)},getAttr:function(b,a){if(a=="class"){return b.className||""}return b.getAttribute(a)||""},setStyles:function(c,b){for(var a in b){if(a=="cssFloat"){c.style.styleFloat=b[a];continue}c.style[a]=b[a]}return c},checkVal_w:function(a){switch(a){case"width":case"marginLeft":case"marginRight":case"paddingLeft":case"paddingRight":case"borderLeftWidth":case"borderRightWidth":return true;default:return false}},checkVal_h:function(a){switch(a){case"height":case"marginTop":case"marginBottom":case"paddingTop":case"paddingBottom":case"borderTopWidth":case"borderBottomWidth":return true;default:return false}},getFontSize:function(d){var b=tyz.newEle("DIV",{},{width:"10em"}),a;try{d.appendChild(b);a=Math.ceil(b.offsetWidth/10);d.removeChild(b)}catch(c){if(d.parentNode&&d.parentNode.nodeName!="HTML"){a=h2v_ie.getFontSize(d.parentNode)}else{a=14}}return a},getSize:function(f,h,b){var e=f.currentStyle[h];if(e.match("px")){return e.replace("px","")*1}if(e.match("%")){var d=e.replace("%","")/100,a=h2v_ie.checkVal_w(h)?"width":"height",g=h2v_ie.getSize(f.parentNode,a,true);return d*g}if(e.match("pt")){return tyz.round(e.replace("pt","")*3/4+0.01,0)}if(e.match("em")){return tyz.round(e.replace("em","")*tyz.PX(h2v_ie.getFontSize(f))+0.01,0)}if(e.match("auto")){if(h=="width"){return(f.offsetWidth-h2v_ie.getPxStyle(f,"paddingLeft")-h2v_ie.getPxStyle(f,"paddingRight")-h2v_ie.getPxStyle(f,"borderLeftWidth")-h2v_ie.getPxStyle(f,"borderRightWidth"))}if(h=="height"&&b){return(f.offsetHeight-h2v_ie.getPxStyle(f,"paddingTop")-h2v_ie.getPxStyle(f,"paddingBottom")-h2v_ie.getPxStyle(f,"borderTopWidth")-h2v_ie.getPxStyle(f,"borderBottomWidth"))}return 0}if(h.match(/border/)){var c=h2v_ie.getStyle(f,h.replace("Width","Style"));if(c!="none"&&c!="hidden"){if(e=="thin"){return 2}if(e=="medium"){return 4}if(e=="thick"){return 6}}return 0}return 0},extractRange:function(c,f){var e=document.createDocumentFragment();var h=c.childNodes.length;while(1){var b=c.firstChild;if(!b){break}if(b===f){e.appendChild(c.removeChild(b));break}var d=false;if(b.nodeName!="#text"){var g=f;if(g.nodeName=="#text"){g=g.parentNode;if(g.nodeName=="#document-fragment"){d=false}else{d=b.contains(g)}}else{d=b.contains(g)}}if(d){e.appendChild(b.cloneNode(false));var a=h2vconvert.extractRange(b,f);e.lastChild.appendChild(a);if(!b.hasChildNodes()){c.removeChild(b)}break}else{e.appendChild(c.removeChild(b))}}return e},extractNodeContents:function(c){var b=document.createDocumentFragment(),a=c.firstChild;while(a){b.appendChild(c.removeChild(a));a=c.firstChild}return b},getOH:function(a){var c=h2vconvert,d=a.cloneNode(true);c.tmpdiv.appendChild(d);var b=d.offsetHeight+1+"px";c.tmpdiv.removeChild(d);return b},setStyleSheet:function(){var a=document.styleSheets[document.styleSheets.length-1];a.addRule(".h2v_e span.h2v_sp","height:1em;");if(h2vconvert.envs.isIE8){var a=document.styleSheets[document.styleSheets.length-1];a.addRule(".h2v_e span.h2v_cho","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1, mirror=1);");a.addRule(".h2v_e span.h2v_alpha,.h2v_e span.h2v_sp,.h2v_e span.h2v_rotate","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);");a.addRule(".h2v_e .h2v_kakko_t,.h2v_e .h2v_kakko_b","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);font-family:'ＭＳ ゴシック','MS Gochic' !important;")}},setTextAlign:function(b,c,h,d,g){var f,a,e=h2vconvert;if(b.hasChildNodes()&&b.lastChild.nodeName=="BR"){g=true;if(b.childNodes.length!=1){b.removeChild(b.lastChild)}}if(h.tAlign==3||h.tAlign==0){return b}f=tyz.newEle("DIV",{},{fontSize:d+"px"});f.appendChild(b);e.tmpdiv.appendChild(f);a=(c-b.offsetHeight)/h.tAlign;b.style.marginTop=tyz.PX(b.style.marginTop)+a+"px";e.tmpdiv.removeChild(f);return b}};(function(){var d=h2vconvert,e=d.envs;e.ua=navigator.userAgent.toLowerCase();var a=e.ua,f=window.opera?(opera.version().replace(/\d$/,"")-0):parseFloat((/(?:ie |fox\/|ome\/|ion\/)(\d+\.\d)/.exec(a)||[,0])[1]);if(/msie/.test(a)){if(document.documentMode!==undefined){f=document.documentMode}}if((/opera/.test(a)&&f<10.5)||(/firefox/.test(a)&&f<3.5)||((!/chrome/.test(a)&&!/opera/.test(a)&&/safari/.test(a)&&!/mobile/.test(a))&&f<3)||(/msie/.test(a)&&f<8)){e.isOld=true}if(/msie/.test(a)){e.isIE=true}if(/msie/.test(a)&&f<9){e.isIE8=true}if(e.isIE8){tyz.getStyle=h2v_ie.getStyle;tyz.getStyles=h2v_ie.getStyles;tyz.getPxStyle=h2v_ie.getPxStyle;tyz.setStyles=h2v_ie.setStyles;d.extractRange=h2v_ie.extractRange;d.extractNodeContents=h2v_ie.extractNodeContents;d.setTextAlign=h2v_ie.setTextAlign;tyz.newEle("RB")}if(/webkit|opera/.test(a)){d.getExtraHeight=d.getExtraHeight_webkit}if(document.addEventListener){window.addEventListener("resize",h2vconvert.doresize,false)}else{window.attachEvent("onresize",h2vconvert.doresize)}var h,b,c;var j,g;if(/windows nt 5/.test(a)){h=d.kakko_t_a.concat(d.kakko_b_a,d.dash_a);b=d.kakko_t_r_a.concat(d.kakko_b_r_a,d.dash_r_a);d.orig_ex=RegExp("("+h.join("|")+")","g");for(c=0;c<h.length;c++){d.repl_a[h[c]]=b[c]}d.kakkos_tr+=d.kakko_t_kagi_a.join("");d.kakkos_br+=d.kakko_b_kagi_a.join("");j=d.kakko_t_r_a.join("");g=d.kakko_b_r_a.join("")}else{h=d.kakko_t_a.concat(d.kakko_b_a,d.kakko_t_kagi_a,d.kakko_b_kagi_a,d.dash_a);b=d.kakko_t_r_a.concat(d.kakko_b_r_a,d.kakko_t_kagi_r_a,d.kakko_b_kagi_r_a,d.dash_r_a);d.orig_ex=RegExp("("+h.join("|")+")","g");for(c=0;c<h.length;c++){d.repl_a[h[c]]=b[c]}j=d.kakko_t_r_a.join("")+d.kakko_t_kagi_r_a.join("");g=d.kakko_b_r_a.join("")+d.kakko_b_kagi_r_a.join("")}h2vconvert.ptn=RegExp("(["+d.komojis+"])|(["+d.rotate_mirrors+"])|(["+d.kutos+"])|([\\s　])|([!-~‘”“’]+\\s?)|(["+j+"])|(["+g+"])|(["+d.kakkos_tr+"])|(["+d.kakkos_br+"])|(["+d.rotates+"])|([！？])","g")})();